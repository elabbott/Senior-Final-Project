<header>
      <%= render 'layouts/navigation' %>
</header>
<% if current_user.user_type == 1 %>
    
<h1 class="text-center">Welcome, <%= current_user.fname %> <%= current_user.lname %></h1>

<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
	<div class="panel panel-default">
		<div class="panel-heading" role="tab" id="headingOne">
			<h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion1<%=params[:id]%>" href="#collapseOne1<%=params[:id]%>" aria-expanded="false" aria-controls="collapseOne"> Schools </a></h4>
		</div>
		<div id="collapseOne1<%=params[:id]%>" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
			<div class="panel-body">
				<table class="table table-striped table-bordered">
					<thead>
						<tr>
							<th>School</th>
							<th>Zipcode</th>
							<th>School ID</th>
							<th>Select</th>
						</tr>
					</thead>
					<tbody>
						<% School.all.each do |schools| %>
						<tr>
							<td><%= schools.name %></td>
							<td><%= schools.zipcode%></td>
							<td><%= schools.school_id %></td>
							<td><%= button_to 'Display Data', '#', 'data-target' => "#myModal_#{schools.school_id}",:method => :get, 'data-toggle' => 'modal',:class => 'btn btn-primary btn-block' %>
								<div class="modal fade" id='<%= "myModal_#{schools.school_id}" %>' tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
									<div class="modal-dialog">
										<div class="modal-content">
											<div class="modal-header">
												<h2 class="modal-title" id="myModalLabel" style="color: black">School: <%= schools.name %></h2>
											</div>
											<div class="modal-body">
												<%= render :partial => 'school_data', :locals => {:id => schools.id} %>
											</div>
										</div>
									</div>
								</div></td>
						</tr>
						<% end %>
					</tbody>
				</table>
			</div>
		</div>
		<div class="panel-heading" role="tab" id="headingOne">
			<h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion2<%=params[:id]%>" href="#collapseOne2<%=params[:id]%>" aria-expanded="false" aria-controls="collapseOne"> Meals</a></h4>
		</div>
		<div id="collapseOne2<%=params[:id]%>" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
			<div class="panel-body">
												<%= render :partial => 'meal_data'%>

			</div>
		</div>
	</div>
</div>
<% elsif current_user.user_type == 2 && current_user.approved == true%>
	<h1 class="text-center">Welcome, <%= current_user.fname %> <%= current_user.lname %>.</h1>
		<table class="table table-striped table-bordered">
		<thead>
		Your franchise list.
			<tr>
				<td>ID</td>
				<td>School ID</td>
				<td>Approved</td>
			</tr>
		</thead>
		<tbody>
			<% Franchise.where(:user_id => current_user.id).each do |franchises|%>
			<tr>
				<td><%= franchises.id%></td>
				<td><%= franchises.school_id%></td>
				<td><%= franchises.approved%></td>
				<td><%= link_to "View Franchise Page", franchise, :class => "btn btn-primary" %></td>
			</tr>
			<% end %>
		</tbody>
	</table>

<% elsif current_user.user_type == 2 && current_user.approved == false%>
	<h1 class="text-center">Welcome, Unapproved Franchise Owner: <%= current_user.fname %> <%= current_user.lname %>.</h1>
		<div class="text-center">
		<%= link_to "Request Franchise", new_franchise_path, :class => "btn btn-primary" %>
		</div>
		<table class="table table-striped table-bordered">
		<thead>
		Schools in your zipcode.
			<tr>
				<td>Name</td>
			</tr>
		</thead>
		<tbody>
			<% School.where(:zipcode => current_user.zipcode).each do |schools|%>
			<tr>
				<td><%= schools.name%></td>
			</tr>
			<% end %>
		</tbody>
	</table>


<% elsif current_user.user_type == 3 %>
	<h1>Welcome, Chef <%= current_user.fname%> <%= current_user.lname%></h1>
	
	<div class="text-center">
		<%= link_to "Create Meal", new_meal_path, :class => "btn btn-primary" %>
	</div>
	<table class="table table-striped table-bordered">
		<thead>
			<tr>
				<td>Name</td>
				<td>Description</td>
				<td>Calories</td>
				<td>Price</td>
				<td>Edit</td>
			</tr>
		</thead>
		<tbody>
			<% Meal.all.each do |meals|%>
			<tr>
				<td><%= meals.name%></td>
				<td><%= meals.description%></td>
				<td><%= meals.calories%></td>
				<td><%= meals.price %></td>
				<td><%= link_to "Edit Meal", edit_meal_path(meals), :class => "btn btn-primary"%></td>
			</tr>
			<% end %>
		</tbody>
	</table>

<% elsif current_user.user_type == 4 %>
	<h1 class="text-center">Hello, Admin <%= current_user.fname%> <%= current_user.lname %></h1>
	
	<div class="text-center">
		<%= link_to "Active Admin Dashboard", admin_dashboard_path, :class => 'btn btn-primary btn-lg'%>
	</div>
	<table class="table table-striped table-bordered">
		<thead>
		Franchises Owners that need approval.
			<tr>
				<td>Name</td>
				<td>Zipcode</td>
				<td>email</td>
			</tr>
		</thead>
		<tbody>
			<% User.where(:approved => false).each do |users|%>
			<tr>
				<td><%= users.fname%>, <%= users.lname%></td>
				<td><%= users.zipcode %></td>
				<td><%= users.email%></td>
				<td><%= button_to 'Approve'  %> </td>
			</tr>
			<% end %>
		</tbody>
	</table>
	<table class="table table-striped table-bordered">
		<thead>
		Franchises that need approval.
			<tr>
				<td>Owner ID</td>
				<td>School ID</td>
				<td>Zipcode</td>
			</tr>
		</thead>
		<tbody>
			<% Franchise.where(:approved => false ).each do |franchises|%> <!-- not quite perfect still shows unapproved users -->
			<tr>
				<td><%= franchises.user_id %></td>
				<td><%= franchises.school_id %></td>
				<td><%= franchises.zipcode %></td>
				<td><%= button_to 'Approve' %> </td>
			</tr>
			<% end %>
		</tbody>
	</table>
<% end %>


